ä½ èŠ±äº†ä¸€æ•´å¤©åœ¨æœ¬åœ°æ­å»ºå¥½é¡¹ç›®ç¯å¢ƒï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½è¿è¡Œå®Œç¾ã€‚ä½†å½“éœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨æˆ–åˆ†äº«ç»™åŒäº‹æ—¶ï¼Œå´æ¥è¿é‡åˆ°"ä¾èµ–ç¼ºå¤±"ã€"ç‰ˆæœ¬å†²çª"ã€"ç¯å¢ƒä¸å…¼å®¹"ç­‰é—®é¢˜...

Docker å°±æ˜¯æ¥è§£å†³è¿™äº›ç—›ç‚¹çš„ã€‚

## Docker æ˜¯ä»€ä¹ˆï¼Ÿ
Docker æ˜¯ä¸€ä¸ªå¼€æºçš„**åº”ç”¨å®¹å™¨å¼•æ“**ï¼Œå®ƒå…è®¸å¼€å‘è€…å°†åº”ç”¨åŠå…¶æ‰€æœ‰ä¾èµ–ï¼ˆåº“ã€é…ç½®æ–‡ä»¶ã€è¿è¡Œæ—¶ç­‰ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª**æ ‡å‡†åŒ–çš„å•å…ƒ**ä¸­ï¼Œè¿™ä¸ªå•å…ƒè¢«ç§°ä¸º **Docker é•œåƒ (Image)**ã€‚

å¯ä»¥æŠŠå®ƒå½¢è±¡åœ°ç†è§£ä¸ºä¸€ä¸ªâ€œ**æ ‡å‡†åŒ–çš„è½¯ä»¶é›†è£…ç®±**â€ã€‚

Docker é•œåƒç¡®ä¿äº†è½¯ä»¶çš„åˆ†å‘å’Œè¿è¡Œæ ‡å‡†ã€‚æ— è®ºæ˜¯åœ¨ä½ çš„ç¬”è®°æœ¬ç”µè„‘ã€æµ‹è¯•æœåŠ¡å™¨è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œåªè¦å®‰è£…äº† Dockerï¼Œè¿™ä¸ªâ€œè½¯ä»¶é›†è£…ç®±â€â€”â€”å³ **Docker å®¹å™¨ (Container)**ï¼ˆé•œåƒçš„è¿è¡Œå®ä¾‹ï¼‰â€”â€” å°±èƒ½**ä¸€é”®å¯åŠ¨**ï¼Œå¹¶ä¸”è¡¨ç°å¾—**å®Œå…¨ä¸€è‡´**ã€‚



## Docker çš„æ ¸å¿ƒä¼˜åŠ¿
**ğŸ¯**** **å½»åº•è§£å†³ç¯å¢ƒå·®å¼‚é—®é¢˜ï¼Œç¡®ä¿å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒçš„é«˜åº¦ä¸€è‡´æ€§ã€‚

**âš¡**** **ç›¸æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºï¼ŒDocker å®¹å™¨å¯åŠ¨é€Ÿåº¦è¾¾åˆ°ç§’çº§ï¼Œèµ„æºå ç”¨æ›´å°‘ï¼Œè¿è¡Œæ•ˆç‡æ›´é«˜ã€‚

**ğŸ”’**** **æ¯ä¸ªåº”ç”¨è¿è¡Œåœ¨ç‹¬ç«‹çš„å®¹å™¨ä¸­ï¼Œäº’ä¸å½±å“ï¼Œå¯ä»¥å®‰å…¨åœ°è¿è¡Œä¸åŒç‰ˆæœ¬ä¾èµ–çš„æœåŠ¡ã€‚

**ğŸš€**** **ä¸€æ¬¡æ„å»ºï¼Œå¤„å¤„è¿è¡Œã€‚ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œå®ç°åº”ç”¨çš„å¿«é€Ÿè¿­ä»£ä¸å¼¹æ€§ä¼¸ç¼©ã€‚

**â˜ï¸**** **ä¸»æµäº‘å¹³å°ï¼ˆAWSã€é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰éƒ½æä¾›å®¹å™¨æœåŠ¡ï¼Œå¯ç›´æ¥éƒ¨ç½² Docker é•œåƒã€‚



## è™šæ‹Ÿæœº VS å®¹å™¨
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748099781568-2b64adfa-00d7-462e-8132-16363126fc92.png)

| ç‰¹æ€§ | è™šæ‹Ÿæœº (VM) | å®¹å™¨ (Container) |
| :--- | :--- | :--- |
| **éš”ç¦»æ€§** | å¼ºï¼ˆç¡¬ä»¶çº§éš”ç¦»ï¼‰ | ä¸­ç­‰ï¼ˆè¿›ç¨‹çº§éš”ç¦»ï¼‰ |
| **èµ„æºå ç”¨** | é«˜ï¼ˆéœ€åˆ†é…å›ºå®šèµ„æºï¼‰ | ä½ï¼ˆåŠ¨æ€å…±äº«èµ„æºï¼‰ |
| **å¯åŠ¨é€Ÿåº¦** | æ…¢ï¼ˆåˆ†é’Ÿçº§ï¼‰ | å¿«ï¼ˆç§’çº§ï¼‰ |
| **å­˜å‚¨å ç”¨** | å¤§ï¼ˆGB çº§ï¼‰ | å°ï¼ˆMB çº§ï¼‰ |
| **ç³»ç»Ÿè¦æ±‚** | éœ€å®Œæ•´æ“ä½œç³»ç»Ÿ | å…±äº«å®¿ä¸»æœºå†…æ ¸ |
| **æ€§èƒ½å¼€é”€** | è¾ƒé«˜ | æ¥è¿‘åŸç”Ÿæ€§èƒ½ |


è™šæ‹Ÿæœºå’Œå®¹å™¨æœ€æœ¬è´¨çš„åŒºåˆ«å°±æ˜¯è™šæ‹ŸåŒ–çš„å±‚æ¬¡ä¸åŒã€‚

è™šæ‹Ÿæœºæ˜¯æŠŠ**æ•´ä¸ªæ“ä½œç³»ç»Ÿéƒ½è™šæ‹Ÿå‡ºæ¥**ï¼Œå°±åƒä½ åœ¨ä¸€å°ç”µè„‘ä¸Šå®‰è£…äº†å¥½å‡ ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œæ¯ä¸ªéƒ½æœ‰è‡ªå·±çš„å†…æ ¸ã€é©±åŠ¨ä»€ä¹ˆçš„ã€‚

è€Œå®¹å™¨å‘¢ï¼Œå®ƒåªæ˜¯æŠŠ**åº”ç”¨ç¨‹åºéš”ç¦»å¼€**ï¼Œå¤§å®¶è¿˜æ˜¯å…±ç”¨åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ã€‚

è¿™å°±å¯¼è‡´äº†å¾ˆæ˜æ˜¾çš„å·®å¼‚ï¼šè™šæ‹Ÿæœºå¯åŠ¨è¦å¥½å‡ åˆ†é’Ÿï¼Œå› ä¸ºè¦å¯åŠ¨æ•´ä¸ªæ“ä½œç³»ç»Ÿï¼›å®¹å™¨å‡ ç§’é’Ÿå°±èƒ½èµ·æ¥ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿå·²ç»åœ¨é‚£äº†ã€‚

èµ„æºæ¶ˆè€—ä¸Šï¼Œè™šæ‹Ÿæœºä¹Ÿè¦é‡å¾—å¤šï¼Œä¸€ä¸ªè™šæ‹Ÿæœºå¯èƒ½è¦å å‡ ä¸ª G çš„å†…å­˜ï¼Œè€Œå®¹å™¨å¯èƒ½åªè¦å‡ å Mã€‚

ä¸è¿‡è™šæ‹Ÿæœºçš„éš”ç¦»æ€§æ›´å¥½ï¼Œä¸€ä¸ªè™šæ‹Ÿæœºå´©äº†ä¸ä¼šå½±å“å…¶ä»–çš„ï¼Œè€Œå®¹å™¨å› ä¸ºå…±äº«å†…æ ¸ï¼Œç†è®ºä¸Šå®‰å…¨æ€§ä¼šå·®ä¸€ç‚¹ã€‚

æ‰€ä»¥é€‰æ‹©å“ªä¸ªä¸»è¦çœ‹ä½ çš„éœ€æ±‚ï¼Œå¦‚æœè¦å¿«é€Ÿéƒ¨ç½²å’Œæ‰©å±•ï¼ˆå¾®æœåŠ¡å¾ˆé€‚åˆï¼‰ï¼Œå®¹å™¨æ›´åˆé€‚ï¼›å¦‚æœè¦å¼ºéš”ç¦»æˆ–è€…è¿è¡Œä¸åŒæ“ä½œç³»ç»Ÿï¼Œè™šæ‹Ÿæœºæ›´å¥½ã€‚



## Docker æ ¸å¿ƒæ¦‚å¿µ
### é•œåƒï¼ˆImageï¼‰
å®ƒæ˜¯ä¸€ä¸ª**åªè¯»çš„æ¨¡æ¿**ï¼Œå°±åƒä¸€å¼ â€œå…‰ç›˜â€æˆ–è€…ä¸€ä¸ªâ€œå®‰è£…åŒ…â€ã€‚é‡Œé¢åŒ…å«äº†è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰ä¸œè¥¿ï¼šä»£ç ã€è¿è¡Œæ—¶åº“ã€ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ç­‰ã€‚

é•œåƒæ˜¯åˆ†å±‚çš„ï¼Œæ¯ä¸€å±‚éƒ½æ˜¯ä¸€äº›æ–‡ä»¶å˜æ›´çš„è®°å½•ï¼Œè¿™ç§è®¾è®¡è®©é•œåƒæ„å»ºå’Œåˆ†å‘æ›´é«˜æ•ˆã€‚

ä½ å¯ä»¥è‡ªå·±åˆ›å»ºé•œåƒï¼Œä¹Ÿå¯ä»¥ä»å…¬å…±æˆ–ç§æœ‰çš„ä»“åº“ (Repository) ä¸‹è½½åˆ«äººåšå¥½çš„é•œåƒã€‚

### å®¹å™¨ï¼ˆContainerï¼‰
é•œåƒæ˜¯é™æ€çš„æ¨¡æ¿ï¼Œè€Œå®¹å™¨æ˜¯**é•œåƒè¿è¡Œèµ·æ¥çš„å®ä¾‹**ã€‚ä½ å¯ä»¥æŠŠé•œåƒçœ‹æˆç±» (Class)ï¼Œå®¹å™¨å°±æ˜¯è¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡ (Instance)ã€‚

å®¹å™¨è¢«å¯åŠ¨åï¼Œå°±åœ¨ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œæœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œç©ºé—´å’Œè¿›ç¨‹ç©ºé—´ã€‚

å®¹å™¨å¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚

### ä»“åº“ï¼ˆRepositoryï¼‰
å°±æ˜¯å­˜æ”¾é•œåƒçš„åœ°æ–¹ï¼Œå¥½æ¯”ä»£ç ä»“åº“ï¼ˆåƒ GitHubï¼‰ã€‚

æœ€è‘—åçš„å…¬å…±ä»“åº“æ˜¯ **Docker Hub**ï¼Œä¸Šé¢æœ‰æˆåƒä¸Šä¸‡çš„å®˜æ–¹å’Œç¤¾åŒºè´¡çŒ®çš„é•œåƒï¼ˆæ¯”å¦‚ Nginxã€MySQLã€Redis ç­‰ï¼‰ã€‚ä½ ä¹Ÿå¯ä»¥æ­å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“ã€‚

### Dockerfile
è¿™æ˜¯ä¸€ä¸ª**æ–‡æœ¬æ–‡ä»¶**ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨æ¥å‘Šè¯‰ Docker å¦‚ä½•ä¸€æ­¥æ­¥è‡ªåŠ¨æ„å»ºä¸€ä¸ªé•œåƒã€‚æ¯”å¦‚ï¼ŒåŸºäºå“ªä¸ªåŸºç¡€é•œåƒã€å¤åˆ¶å“ªäº›æ–‡ä»¶è¿›å»ã€å®‰è£…ä»€ä¹ˆä¾èµ–ã€å®¹å™¨å¯åŠ¨æ—¶é»˜è®¤æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ç­‰ç­‰ã€‚

### æ•°æ®å·ï¼ˆVolumeï¼‰
å®¹å™¨é»˜è®¤æ˜¯æ— çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®¹å™¨åˆ é™¤åï¼Œé‡Œé¢äº§ç”Ÿçš„æ•°æ®ä¹Ÿå°±æ²¡äº†ã€‚æ•°æ®å·å°±æ˜¯ç”¨æ¥**æŒä¹…åŒ–å­˜å‚¨æ•°æ®**çš„ã€‚

å®ƒå¯ä»¥è®©æ•°æ®ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå­˜åœ¨ï¼Œå³ä½¿å®¹å™¨è¢«åˆ é™¤äº†ï¼Œæ•°æ®å·é‡Œçš„æ•°æ®ä¾ç„¶ä¿ç•™ã€‚ä¹Ÿå¯ä»¥ç”¨äºå®¹å™¨é—´å…±äº«æ•°æ®ã€‚

### ç½‘ç»œï¼ˆNetworkï¼‰
Docker å…è®¸å®¹å™¨ä¹‹é—´ã€å®¹å™¨ä¸å®¿ä¸»æœºã€å®¹å™¨ä¸å¤–éƒ¨ç½‘ç»œä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚å®ƒæä¾›äº†å¤šç§ç½‘ç»œæ¨¡å¼ï¼ˆå¦‚æ¡¥æ¥æ¨¡å¼ã€ä¸»æœºæ¨¡å¼ï¼‰æ¥æ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚



## å®‰è£… Docker
é¦–å…ˆéœ€è¦å®‰è£… Dockerï¼Œç›´æ¥ä»[å®˜ç½‘](https://www.docker.com/products/docker-desktop/)ä¸‹è½½ Docker Desktop å°±è¡Œï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1747929949258-2da4968a-793c-4b9e-b33b-728cc819f7d9.png)

Docker Desktop æä¾›äº†ä¸€ä¸ªå›¾å½¢åŒ–ç•Œé¢ï¼Œæ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹å’Œç®¡ç†æœ¬åœ°çš„é•œåƒï¼ˆImagesï¼‰ã€è¿è¡Œä¸­çš„å®¹å™¨ï¼ˆContainersï¼‰ å’Œæ•°æ®å·ï¼ˆVolumesï¼‰ ç­‰ã€‚

å®‰è£…å®Œæˆå‘½ä»¤è¡Œè¾“å…¥ `docker -h` çœ‹ä¸‹ docker å‘½ä»¤æ˜¯å¦å¯ç”¨ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748312091716-490b589d-bcc9-4418-b7b7-ed5b20af40d7.png)



## ğŸŒ° æ‹‰å–å¹¶è¿è¡Œä¸€ä¸ª Nginx é•œåƒ
1. **æœç´¢é•œåƒ**ï¼šåœ¨ Docker Desktop çš„æœç´¢æ¡†é‡Œè¾“å…¥ `nginx`ï¼Œå®ƒä¼šä» Docker Hub æœç´¢ã€‚æ‰¾åˆ°å®˜æ–¹çš„ `nginx` é•œåƒï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1747972703958-24d65b26-7556-44e0-9804-7024ad544f9f.png)

2. **æ‹‰å–é•œåƒ (Pull)**ï¼šæ‰¾åˆ°å®˜æ–¹çš„ `nginx` é•œåƒï¼Œç‚¹å‡»æ—è¾¹çš„ "Pull" æŒ‰é’®ã€‚é€‰æ‹©ä¸€ä¸ªæ ‡ç­¾ï¼ˆtagï¼‰ï¼Œæ¯”å¦‚ `latest` è¡¨ç¤ºæœ€æ–°ç‰ˆï¼Œç„¶åç­‰å¾…ä¸‹è½½å®Œæˆã€‚ 

ä¸‹è½½å®Œæˆåï¼Œä½ å¯ä»¥åœ¨ "Images" åˆ—è¡¨é‡Œçœ‹åˆ°è¿™ä¸ª `nginx` é•œåƒï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100122314-1b49e6ee-d762-46df-8e60-4c351aa8009e.png)

3. **è¿è¡Œé•œåƒ (Run)**ï¼šåœ¨ "Images" åˆ—è¡¨é‡Œæ‰¾åˆ° `nginx` é•œåƒï¼Œç‚¹å‡»å®ƒå³ä¾§çš„ "Run" æŒ‰é’®ã€‚è¿™æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªé…ç½®çª—å£ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100151971-89b09d77-8ece-4125-853c-7a9cf0175b79.png)

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100155471-d052c3de-6885-41e9-8347-cfde91d8ea36.png)

è§£é‡Šä¸‹è¿™äº›é…ç½®ï¼š

+ **Container name (å®¹å™¨åç§°)**ï¼šç»™ä½ çš„å®¹å™¨èµ·ä¸ªåå­—ï¼Œæ¯”å¦‚ `nginx-test`ã€‚ä¸å¡«çš„è¯ Docker ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºåå­—ã€‚
+ **Ports (ç«¯å£æ˜ å°„)**ï¼š
    - Nginx åœ¨å®¹å™¨å†…éƒ¨é»˜è®¤ç›‘å¬ `80` ç«¯å£ã€‚
    - æˆ‘ä»¬éœ€è¦æŠŠå®¿ä¸»æœºçš„ä¸€ä¸ªç«¯å£ï¼ˆæ¯”å¦‚ 80ï¼‰æ˜ å°„åˆ°å®¹å™¨çš„ `80` ç«¯å£ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬è®¿é—®å®¿ä¸»æœºçš„ `80` ç«¯å£æ—¶ï¼Œè¯·æ±‚å°±ä¼šè¢«è½¬å‘åˆ°å®¹å™¨å†…çš„ Nginx æœåŠ¡ã€‚æ ¼å¼æ˜¯ `å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£`ï¼Œä¾‹å¦‚ `80:80`ã€‚
+ **Volumes (æ•°æ®å·æŒ‚è½½)**ï¼š
    - è¿™æ˜¯å®ç°æ•°æ®æŒä¹…åŒ–å’Œå†…å®¹æ›¿æ¢çš„å…³é”®ã€‚Nginx é»˜è®¤çš„ç½‘ç«™æ ¹ç›®å½•åœ¨å®¹å™¨å†…çš„ `/usr/share/nginx/html`ã€‚
    - æˆ‘ä»¬å¯ä»¥æŠŠå®¿ä¸»æœºçš„ä¸€ä¸ªç›®å½• `/tmp/test `æŒ‚è½½åˆ°å®¹å™¨çš„ `/usr/share/nginx/html` ç›®å½•ã€‚
    - **Host path (å®¿ä¸»æœºè·¯å¾„)**ï¼šå¡«å†™è‡ªå·±æœ¬åœ°çš„ç›®å½•ã€‚
    - **Container path (å®¹å™¨å†…è·¯å¾„)**ï¼šå¡«å†™ Nginx é•œåƒé¢„æœŸçš„å†…å®¹è·¯å¾„ï¼Œé€šå¸¸æ˜¯ `/usr/share/nginx/html`ã€‚
+ **Environment variables (ç¯å¢ƒå˜é‡)**ï¼šå¯ä»¥ä¸ºå®¹å™¨è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œä¾›å®¹å™¨å†…è¿è¡Œçš„ç¨‹åºè¯»å–ã€‚è¿™é‡Œ Nginx æš‚æ—¶ç”¨ä¸åˆ°ã€‚
4. **å¯åŠ¨å®¹å™¨**ï¼šé…ç½®å¥½ä¹‹åï¼Œç‚¹å‡» "Run" æŒ‰é’®ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100377145-82ae42ed-0b8b-4742-93e5-3abd5d5a571b.png)

è¿™æ · Nginx å®¹å™¨å·²ç»åœ¨è¿è¡Œäº†ã€‚



## éªŒè¯æ•°æ®å·æŒ‚è½½
1. **åœ¨å®¿ä¸»æœºåˆ›å»ºæ–‡ä»¶**ï¼š

å…ˆè¿›å…¥/tmp/test ç›®å½•ä¸‹ï¼š

```bash
cd /tmp/test

# å¦‚æœæ²¡æœ‰è¿™ä¸ªç›®å½•ï¼Œå…ˆåˆ›å»º
mkdir /tmp/test
```

åœ¨è¿™ä¸ªç›®å½•æ·»åŠ  index.htmlï¼š

```bash
echo "hello" > ./index.html
```

2. **è®¿é—® Nginx æœåŠ¡**ï¼šæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://localhost:80`ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100496583-8e8fd8e3-4f3a-436f-9159-3efbc065ddc4.png)

è¿™å°±è¯´æ˜æ•°æ®å·æŒ‚è½½æˆåŠŸäº†ã€‚å®¹å™¨å†…çš„ Nginx è¯»å–çš„æ˜¯å®¿ä¸»æœºç›®å½•ä¸‹çš„åˆšåˆšåˆ›å»ºçš„ index.html æ–‡ä»¶ã€‚

3. **æŸ¥çœ‹å®¹å™¨å†…æ–‡ä»¶ (å¯é€‰)**ï¼šåœ¨ Docker Desktop ä¸­ï¼Œç‚¹å¼€æ­£åœ¨è¿è¡Œçš„ `nginx-test` å®¹å™¨ï¼Œåˆ‡æ¢åˆ° "Files" æ ‡ç­¾é¡µã€‚

ä½ åº”è¯¥èƒ½çœ‹åˆ°å®¹å™¨å†…çš„ `/usr/share/nginx/html` ç›®å½•è¢«æ ‡è®°ä¸º `mounted` (å·²æŒ‚è½½)ï¼Œå¹¶ä¸”é‡Œé¢æœ‰æˆ‘ä»¬çš„ `index.html` æ–‡ä»¶ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100585559-638bed7c-bb06-492a-aceb-067b9e7a25b3.png)

å¦‚æœä½ åœ¨æŒ‚è½½æŸäº›ç›®å½•æ—¶é‡åˆ°æƒé™é”™è¯¯ï¼Œå¯èƒ½éœ€è¦åœ¨ Docker Desktop çš„ Settings > Resources > File Sharing é‡ŒæŠŠä½ æƒ³è¦å…±äº«çš„å®¿ä¸»æœºç›®å½•æ·»åŠ è¿›å»ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748310966899-41fb0599-fb4b-49f6-b519-d6bac0b6cb16.png)

è‡³äºå®¹å™¨å†…åº”è¯¥æŒ‚è½½åˆ°å“ªä¸ªç›®å½•ï¼Œé€šå¸¸é•œåƒçš„æ–‡æ¡£ï¼ˆæ¯”å¦‚åœ¨ Docker Hub ä¸Šçš„æè¿°é¡µé¢ï¼‰ä¼šè¯´æ˜ã€‚å¯¹äº Nginxï¼Œæ ‡å‡†è·¯å¾„å°±æ˜¯ `/usr/share/nginx/html`ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100746721-1f199bf6-e21e-450f-babb-233676d4f7c6.png)

é€šè¿‡å‘½ä»¤è¡Œ docker run æ¥è·‘é•œåƒï¼Œ -v æ˜¯æŒ‡å®šæŒ‚è½½çš„æ•°æ®å·ï¼Œåé¢çš„ :ro ä»£è¡¨ readonlyï¼Œä¹Ÿå°±æ˜¯å®¹å™¨å†…è¿™ä¸ªç›®å½•åªè¯»ï¼Œ:rw è¡¨ç¤ºå®¹å™¨å†…å¯ä»¥è¯»å†™è¿™ä¸ªç›®å½•ã€‚

è¿™å°±æ˜¯æ•°æ®å·çš„ä½œç”¨ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥è¿›å…¥å®¹å™¨å†…æ‰§è¡Œå„ç§å‘½ä»¤ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748100789370-f1e9a7f9-1098-452e-9cba-45ed15d7bf7c.png)



## ä½¿ç”¨å‘½ä»¤è¡Œæ“ä½œ
è™½ç„¶ Docker Desktop å¾ˆæ–¹ä¾¿ï¼Œä½†åœ¨æœåŠ¡å™¨ä¸Šæˆ–è€…è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²æ—¶ï¼Œå‘½ä»¤è¡Œæ‰æ˜¯ç‹é“ã€‚ä¸Šé¢å›¾å½¢åŒ–æ“ä½œçš„æ¯ä¸€æ­¥ï¼Œéƒ½æœ‰å¯¹åº”çš„å‘½ä»¤è¡ŒæŒ‡ä»¤ï¼š

### æ‹‰å–é•œåƒ (pull)
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748312138676-c4e36b11-0b0d-45fa-a17b-dd6fb19a01bf.png)

```bash
docker pull nginx:latest
```

è¿™é‡Œçš„ `nginx` æ˜¯é•œåƒåï¼Œ`latest` æ˜¯æ ‡ç­¾ (tag)ï¼Œè¡¨ç¤ºæœ€æ–°ç‰ˆæœ¬ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748101110401-e0d29ce2-320a-4473-b41b-942f2097d201.png)



### è¿è¡Œé•œåƒï¼ˆrunï¼‰
```bash
docker run --name nginx-test2 -p 81:80 -v /tmp/test:/usr/share/nginx/html -e KEY1=VALUE1 -d nginx:latest
```

æˆ‘ä»¬æ¥æ‹†è§£ä¸€ä¸‹è¿™ä¸ªå‘½ä»¤ï¼š

+ `docker run`: è¿è¡Œé•œåƒä»¥åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªæ–°å®¹å™¨ã€‚
+ `--name nginx-test2`: ç»™å®¹å™¨å‘½åä¸º `nginx-test2`ã€‚
+ `-p 81:80`: å°†å®¿ä¸»æœºçš„ `81` ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ `80` ç«¯å£ã€‚
+ ` -v /tmp/test:/usr/share/nginx/html`: æŒ‚è½½æ•°æ®å·ã€‚
    - `/tmp/test:/` æ˜¯å®¿ä¸»æœºè·¯å¾„ ( Mac ç¤ºä¾‹ï¼ŒWindows è¯·ä½¿ç”¨å¯¹åº”è·¯å¾„å¦‚ `D:\my-nginx-content`)ã€‚
    - `/usr/share/nginx/html` æ˜¯å®¹å™¨å†…è·¯å¾„ã€‚
    - é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ç§æŒ‚è½½æ˜¯**å¯è¯»å†™** ï¼ˆ`rw`ï¼‰çš„ã€‚å¦‚æœå¸Œæœ›å®¹å™¨å†…å¯¹è¿™ä¸ªæŒ‚è½½ç›®å½•åªæœ‰**åªè¯»æƒé™**ï¼Œå¯ä»¥åœ¨æœ«å°¾æ·»åŠ  `:ro`ï¼Œä¾‹å¦‚ï¼š`-v /tmp/test:/usr/share/nginx/html:ro`ã€‚
+ `-e KEY1=VALUE1`ï¼š è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå®¹å™¨å†…éƒ¨çš„åº”ç”¨ç¨‹åºå¯ä»¥è¯»å–è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚
+ `-d`: è¡¨ç¤º `detached` æ¨¡å¼ï¼Œå³è®©å®¹å™¨åœ¨åå°è¿è¡Œï¼Œä¸å ç”¨å½“å‰ç»ˆç«¯ã€‚
+ `nginx:latest`: æŒ‡å®šè¦ä½¿ç”¨çš„é•œåƒåŠå…¶æ ‡ç­¾ã€‚

docker run ä¼šè¿”å›ä¸€ä¸ªå®¹å™¨çš„ hashï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748143765819-6e7769e0-b4d5-4100-b0d1-aa58e5b97ca1.png)

å°±æ˜¯è¿™é‡Œçš„ idï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748143772982-b1d67996-cfce-4b4d-93c4-6e9850d354b6.png)

### è·å–å®¹å™¨åˆ—è¡¨ï¼ˆpsï¼‰
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1749039710026-45bbc9db-01ef-4ebe-a0c1-004109eee061.png)

ä¸Šé¢å®¹å™¨åˆ—è¡¨ç•Œé¢å¯ä»¥ç”¨ docker ps æ¥è·å–ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748145301263-43cc4cdf-1e47-4a54-8c5d-58433436e4b3.png)

é»˜è®¤æ˜¾ç¤ºè¿è¡Œä¸­çš„å®¹å™¨ã€‚

å¦‚æœæƒ³æ˜¾ç¤ºå…¨éƒ¨ï¼ŒåŠ ä¸ª -a

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748145311614-b7d6596e-7409-4118-950d-80df268a4bef.png)

### è·å–é•œåƒåˆ—è¡¨ï¼ˆimagesï¼‰
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1749039736379-4a2f69d2-4afe-4a27-a6ce-17cf7f830305.png)

é•œåƒåˆ—è¡¨å¯ä»¥é€šè¿‡ docker images å‘½ä»¤è·å–ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748145327982-bc9f0958-f562-4f99-a25a-3fdc48e62a54.png)

### è¿›å…¥é€€å‡ºå®¹å™¨ terminal
æˆ‘ä»¬åœ¨å®¹å™¨çš„ terminal é‡Œæ‰§è¡Œå‘½ä»¤ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748145405106-7453cfaa-e820-4d8c-a01a-570a25d57dba.png)

å¯¹åº”çš„æ˜¯ docker exec å‘½ä»¤ï¼š

```bash
docker exec [é€‰é¡¹] å®¹å™¨å å‘½ä»¤ [å‚æ•°]
```

[é€‰é¡¹]ï¼šå¯é€‰å‚æ•°ï¼Œç”¨äºè°ƒæ•´å‘½ä»¤è¡Œä¸ºï¼š

+ `-i`ï¼šä¿æŒæ ‡å‡†è¾“å…¥å¼€å¯ï¼ˆäº¤äº’æ¨¡å¼ï¼‰
+ `-t`ï¼šåˆ†é…ä¼ªç»ˆç«¯ï¼ˆé€šå¸¸ä¸ `-i`ä¸€èµ·ä½¿ç”¨ï¼‰
+ `-d`ï¼šåœ¨åå°è¿è¡Œå‘½ä»¤
+ `-u`ï¼šæŒ‡å®šæ‰§è¡Œç”¨æˆ·ï¼ˆå¦‚ `-u root`ï¼‰

å®¹å™¨åï¼šå¿…éœ€å‚æ•°ï¼Œå¯ä»¥æ˜¯å®¹å™¨åç§°æˆ– ID

å‘½ä»¤ï¼šå¿…éœ€å‚æ•°ï¼Œè¦åœ¨å®¹å™¨å†…æ‰§è¡Œçš„å‘½ä»¤ï¼ˆå¦‚ `/bin/bash`ã€`ls` ç­‰ï¼‰

[å‚æ•°]ï¼šå¯é€‰å‚æ•°ï¼Œä¼ é€’ç»™å‘½ä»¤çš„é¢å¤–å‚æ•°

æ¯”å¦‚ä»¥ç‰¹å®šç”¨æˆ·æ‰§è¡Œå‘½ä»¤ï¼š`docker exec -u root mycontainer whoami`ï¼ˆä¼šä»¥ `root` ç”¨æˆ·èº«ä»½æ‰§è¡Œ `whoami` å‘½ä»¤ï¼‰

æ¯”å¦‚è¿›å…¥å®¹å™¨äº¤äº’ç»ˆç«¯ï¼š`docker exec -it my-nginx bash`ï¼ˆæ‰§è¡Œåä¼šè¿›å…¥å®¹å™¨çš„ `bash shell`ï¼Œè¾“å…¥ `exit` å¯é€€å‡ºï¼‰

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155828874-ad5e9a26-24a8-4400-a722-2039fcede177.png)

é€€å‡ºå®¹å™¨ terminalï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155864319-5a23b58f-2e48-47ce-95d7-fe4a1745e68c.png)

### æŸ¥çœ‹æ—¥å¿—ï¼ˆlogsï¼‰
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155885327-0a2159f1-9046-4697-b234-d97970a2bf1d.png)

å¯¹åº” docker logs å‘½ä»¤ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155938007-4438de35-72a6-48a3-b31a-db98a3a7ef9d.png)

### æŸ¥çœ‹å®¹å™¨çš„è¯¦æƒ…ï¼ˆinspectï¼‰
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155948456-6bccb519-63c9-4b85-8307-37a7ce3eb47a.png)

å¯¹åº” docker inspect  å‘½ä»¤ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155954089-255f75a1-ee82-4495-a39e-235100f95022.png)

### æ¨é€é•œåƒï¼ˆpushï¼‰
Docker æä¾›äº† Docker Hub é•œåƒä»“åº“ï¼Œå¯ä»¥æŠŠæœ¬åœ°é•œåƒ push åˆ°ä»“åº“ï¼Œæˆ–ä»ä»“åº“ pull é•œåƒåˆ°æœ¬åœ°ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748156009272-13c50599-eecc-491d-a8b2-1a9cdd8a05eb.png)

é¦–å…ˆå» [Docker Hub](https://hub.docker.com/) æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œç™»å½•åï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748155980761-826e211e-1de2-48aa-8029-4ac1c26cf24c.png)

#### æ ‡è®°é•œåƒ (tag)
åœ¨æ¨é€é•œåƒä¹‹å‰ï¼Œä½ éœ€è¦ä¸ºæœ¬åœ°é•œåƒæ‰“ä¸Šä¸€ä¸ªåŒ…å«**ç›®æ ‡ä»“åº“åœ°å€**å’Œ**æ–°æ ‡ç­¾**çš„æ–°åç§°ï¼š

```bash
docker tag SOURCE_IMAGE[:TAG] [REGISTRY_HOST/][NAMESPACE/]TARGET_IMAGE[:TAG]
```

+ `SOURCE_IMAGE[:TAG]`ï¼šæœ¬åœ°å·²æœ‰çš„é•œåƒåç§°å’Œæ ‡ç­¾ï¼ˆå¦‚ `my-app:latest`ï¼‰ã€‚çœç•¥ `:TAG` æ—¶é»˜è®¤ä¸º `latest`
+ `[REGISTRY_HOST/]`ï¼šï¼ˆå¯é€‰ï¼‰ä»“åº“åœ°å€
    - `docker.io`ï¼šDocker Hubï¼ˆå¯çœç•¥ï¼‰
    - `gcr.io`ï¼šGoogle Container Registry
    - `your-registry.com`ï¼šç§æœ‰ä»“åº“
+ `[NAMESPACE/]`ï¼šï¼ˆå¿…éœ€ï¼‰å‘½åç©ºé—´/ç”¨æˆ·å/é¡¹ç›®å
    - Docker Hubï¼šç”¨æˆ·åï¼Œå¦‚ `yourusername/`
    - ç§æœ‰ä»“åº“ï¼šé¡¹ç›®åï¼Œå¦‚ `my-project/`
+ `TARGET_IMAGE`ï¼šï¼ˆå¿…éœ€ï¼‰ç›®æ ‡é•œåƒåç§°
+ `[:TAG]`ï¼šï¼ˆå¯é€‰ï¼‰æ ‡ç­¾ï¼Œé»˜è®¤ä¸º `latest`

ç¤ºä¾‹ï¼š

```bash
# æ ‡è®°ä¸º Docker Hub é•œåƒ
docker tag my-app:latest yourusername/my-app:1.0

# æ ‡è®°ä¸ºç§æœ‰ä»“åº“é•œåƒ  
docker tag my-app:latest my-registry.com/my-project/my-app:prod

# æ ‡è®°ä¸º Google Container Registry é•œåƒ
docker tag my-app:latest gcr.io/my-gcp-project/my-app:v2.1
```

#### æ¨é€é•œåƒï¼ˆpushï¼‰
é¦–å…ˆç¡®ä¿å·²ç™»å½•åˆ°ç›®æ ‡ä»“åº“

```bash
# ç™»å½• Docker Hub
docker login

# ç™»å½•ç§æœ‰ä»“åº“
docker login my-registry.com
```

æ ‡è®°å®Œæˆåï¼Œæ¨é€é•œåƒåˆ°è¿œç¨‹ä»“åº“ï¼š

```bash
docker push [REGISTRY_HOST/][NAMESPACE/]TARGET_IMAGE[:TAG]
```

æ¨é€çš„é•œåƒåç§°å¿…é¡»ä¸æ ‡è®°æ—¶ä½¿ç”¨çš„åç§°å®Œå…¨ä¸€è‡´ã€‚

ç¤ºä¾‹ï¼š

```bash
docker push yourusername/my-app:1.0
docker push my-registry.com/my-project/my-app:prod
docker push gcr.io/my-gcp-project/my-app:v2.1
```

#### æ‹‰å–é•œåƒï¼ˆpullï¼‰
é•œåƒæ¨é€æˆåŠŸåï¼Œå…¶ä»–ç”¨æˆ·å¯ä»¥æ‹‰å–å¹¶ä½¿ç”¨è¯¥é•œåƒï¼š

```bash
docker pull [REGISTRY_HOST/][NAMESPACE/]TARGET_IMAGE[:TAG]
```

ç¤ºä¾‹ï¼š

```bash
# ä» Docker Hub æ‹‰å–
docker pull yourusername/my-app:1.0

# ä»ç§æœ‰ä»“åº“æ‹‰å–ï¼ˆéœ€è¦å…ˆç™»å½•ï¼‰
docker pull my-registry.com/my-project/my-app:prod

# æ‹‰å–æœ€æ–°ç‰ˆæœ¬ï¼ˆçœç•¥æ ‡ç­¾ï¼‰
docker pull yourusername/my-app
```

+ å…¬å¼€é•œåƒï¼šä»»ä½•äººéƒ½å¯ä»¥æ‹‰å–
+ ç§æœ‰é•œåƒï¼šéœ€è¦ç›¸åº”çš„è®¿é—®æƒé™å’Œç™»å½•è®¤è¯

### ç®¡ç†æ•°æ®å·ï¼ˆvolumeï¼‰
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748158230314-3b85cda2-5611-44d3-817b-f342fc1ebc03.png)

ä½¿ç”¨ docker volume å‘½ä»¤ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748158236213-b96057e4-38aa-4542-87c2-9437d8d05bb8.png)

### å¯åŠ¨åœæ­¢åˆ é™¤å®¹å™¨ï¼ˆstart stop rmï¼‰
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748158578959-3a43fc91-b5d5-43ab-b53d-530a0326be3d.png)

+ `docker start container_name_or_id` å¯åŠ¨ä¸€ä¸ªå·²ç»åœæ­¢çš„å®¹å™¨
+ `docker stop container_name_or_id` åœæ­¢ä¸€ä¸ªå®¹å™¨
+ `docker rm container_name_or_id` åˆ é™¤ä¸€ä¸ªå®¹å™¨ï¼Œå¦‚æœæ­£åœ¨è¿è¡Œï¼Œä¸”ä½ æƒ³å¼ºåˆ¶åˆ é™¤ï¼š`docker rm -f container_name_or_id`



# å¸¸ç”¨ Docker å‘½ä»¤ä¸€è§ˆ
## é•œåƒç®¡ç†
+ `docker pull <image_name>:<tag>` - ä»ä»“åº“æ‹‰å–é•œåƒ
+ `docker images` æˆ– `docker image ls` - åˆ—å‡ºæœ¬åœ°æ‰€æœ‰é•œåƒ
+ `docker rmi <image_id_or_name>` - åˆ é™¤æœ¬åœ°é•œåƒ
+ `docker tag <source_image> <target_image>` - ç»™é•œåƒæ‰“æ ‡ç­¾
+ `docker push <image_name>:<tag>` - æ¨é€é•œåƒåˆ°è¿œç¨‹ä»“åº“
+ `docker login` - ç™»å½•åˆ° Docker ä»“åº“
+ `docker build -t <image_name>:<tag> .` - æ„å»ºé•œåƒ
+ `docker history <image>` - æŸ¥çœ‹é•œåƒæ„å»ºå†å²
+ `docker save -o <file.tar> <image>` - å¯¼å‡ºé•œåƒåˆ°æ–‡ä»¶
+ `docker load -i <file.tar>` - ä»æ–‡ä»¶å¯¼å…¥é•œåƒ

## å®¹å™¨ç®¡ç†
+ `docker run [OPTIONS] IMAGE [COMMAND]` - åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨
+ `docker ps` - åˆ—å‡ºè¿è¡Œä¸­çš„å®¹å™¨
+ `docker ps -a` - åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢ï¼‰
+ `docker start <container>` - å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨
+ `docker stop <container>` - åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨
+ `docker restart <container>` - é‡å¯å®¹å™¨
+ `docker pause <container>` - æš‚åœå®¹å™¨
+ `docker unpause <container>` - æ¢å¤æš‚åœçš„å®¹å™¨
+ `docker rm <container>` - åˆ é™¤å·²åœæ­¢çš„å®¹å™¨
+ `docker rm -f <container>` - å¼ºåˆ¶åˆ é™¤å®¹å™¨ï¼ˆâš ï¸ ä¸æ¨èï¼Œä¼šå‘é€ SIGKILL ä¿¡å·å¼ºè¡Œåœæ­¢è¿è¡Œä¸­çš„å®¹å™¨å†åˆ é™¤ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–çŠ¶æ€å¼‚å¸¸ï¼‰
+ `docker logs <container>` - æŸ¥çœ‹å®¹å™¨æ—¥å¿—
+ `docker logs -f <container>` - å®æ—¶è·Ÿè¸ªæ—¥å¿—
+ `docker exec -it <container> <command>` - åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤
+ `docker attach <container>` - è¿æ¥åˆ°è¿è¡Œä¸­çš„å®¹å™¨
+ `docker inspect <container_or_image>` - æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰
+ `docker stats` - æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
+ `docker cp <src> <dest>` - åœ¨å®¹å™¨å’Œä¸»æœºé—´å¤åˆ¶æ–‡ä»¶
+ `docker rename <old_name> <new_name>` - é‡å‘½åå®¹å™¨

## æ•°æ®å·ç®¡ç†
+ `docker volume ls` - åˆ—å‡ºæ‰€æœ‰æ•°æ®å·
+ `docker volume create <volume_name>` - åˆ›å»ºæ•°æ®å·
+ `docker volume rm <volume_name>` - åˆ é™¤æ•°æ®å·
+ `docker volume inspect <volume_name>` - æŸ¥çœ‹æ•°æ®å·è¯¦æƒ…
+ `docker volume prune` - åˆ é™¤æœªä½¿ç”¨çš„æ•°æ®å·

## ç½‘ç»œç®¡ç†
+ `docker network ls` - åˆ—å‡ºæ‰€æœ‰ç½‘ç»œ
+ `docker network create <network_name>` - åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ
+ `docker network rm <network_name>` - åˆ é™¤ç½‘ç»œ
+ `docker network inspect <network_name>` - æŸ¥çœ‹ç½‘ç»œè¯¦æƒ…
+ `docker network connect <network> <container>` - è¿æ¥å®¹å™¨åˆ°ç½‘ç»œ
+ `docker network disconnect <network> <container>` - æ–­å¼€å®¹å™¨ç½‘ç»œè¿æ¥
+ `docker network prune` - åˆ é™¤æœªä½¿ç”¨çš„ç½‘ç»œ

## ç³»ç»Ÿç®¡ç†
+ `docker info` - æ˜¾ç¤º Docker ç³»ç»Ÿä¿¡æ¯
+ `docker version` - æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
+ `docker system df` - æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ
+ `docker system prune` - æ¸…ç†æœªä½¿ç”¨çš„èµ„æº
+ `docker system prune -a` - æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æºï¼ˆåŒ…æ‹¬é•œåƒï¼‰
+ `docker system events` - å®æ—¶æ˜¾ç¤º Docker äº‹ä»¶



## Docker å®ç°åŸç†
![ç”»æ¿](https://cdn.nlark.com/yuque/0/2025/jpeg/21596389/1748161630523-7bda3ca6-63f3-40e7-84dc-8fa660519eba.jpeg)

### Namespaceï¼šèµ„æºéš”ç¦»æœºåˆ¶
Namespace å¯ä»¥è®©å®¹å™¨ A é‡Œçš„è¿›ç¨‹ä»¥ä¸ºè‡ªå·±çš„ PID æ˜¯ 1ï¼Œæ˜¯ç³»ç»Ÿè€å¤§ï¼Œä½†å…¶å®åœ¨å®¿ä¸»æœºçœ‹æ¥ï¼Œå®ƒå¯èƒ½æ˜¯ PID 12345ã€‚ç½‘ç»œä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ¯ä¸ªå®¹å™¨éƒ½è§‰å¾—è‡ªå·±æœ‰ç‹¬ç«‹çš„ç½‘å¡å’Œ IPï¼Œä½†åº•å±‚éƒ½æ˜¯å®¿ä¸»æœºåœ¨ç»Ÿä¸€ç®¡ç†ã€‚

Namespace ä¸ºå®¹å™¨æä¾›è¿›ç¨‹çº§åˆ«çš„èµ„æºéš”ç¦»ï¼Œç¡®ä¿å®¹å™¨é—´äº’ä¸å¹²æ‰°ï¼š

+ **PID Namespace**ï¼šè¿›ç¨‹ ID ç©ºé—´éš”ç¦»ï¼Œå®¹å™¨å†…è¿›ç¨‹ ID ä» 1 å¼€å§‹é‡æ–°ç¼–å·
+ **Network Namespace**ï¼šç½‘ç»œèµ„æºå®Œå…¨éš”ç¦»ï¼ŒåŒ…æ‹¬ç½‘ç»œæ¥å£ã€è·¯ç”±è¡¨ã€é˜²ç«å¢™è§„åˆ™ç­‰
+ **Mount Namespace**ï¼šæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹éš”ç¦»ï¼Œå®¹å™¨æ‹¥æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿè§†å›¾
+ **IPC Namespace**ï¼šè¿›ç¨‹é—´é€šä¿¡éš”ç¦»ï¼ŒåŒ…æ‹¬ä¿¡å·é‡ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å…±äº«å†…å­˜ç­‰
+ **UTS Namespace**ï¼šä¸»æœºåå’ŒåŸŸåéš”ç¦»ï¼Œå®¹å™¨å¯è®¾ç½®ç‹¬ç«‹çš„ä¸»æœºæ ‡è¯†
+ **User Namespace**ï¼šç”¨æˆ·å’Œç”¨æˆ·ç»„ ID æ˜ å°„éš”ç¦»ï¼Œå®ç°æƒé™å®‰å…¨æ§åˆ¶
+ **Cgroup Namespace**ï¼šcgroups æ ¹ç›®å½•éš”ç¦»ï¼Œæä¾›èµ„æºç®¡ç†è§†å›¾éš”ç¦»

### cgroupsï¼šèµ„æºä½¿ç”¨æ§åˆ¶
å…‰æœ‰éš”ç¦»è¿˜ä¸å¤Ÿï¼Œè¿˜å¾—é˜²æ­¢æŸä¸ªå®¹å™¨æŠŠèµ„æºå…¨å äº†ã€‚cgroups å°±åƒä¸€ä¸ªä¸¥æ ¼çš„ç®¡å®¶ï¼Œç»™æ¯ä¸ªå®¹å™¨åˆ†é…å›ºå®šçš„"é…é¢"ã€‚

ä½ çš„å®¹å™¨æœ€å¤šèƒ½ç”¨ 2 ä¸ª CPU æ ¸å¿ƒã€4GB å†…å­˜ï¼Œè¶…äº†å°±ä¸è¡Œã€‚è¿™æ ·å°±ç®—æŸä¸ªåº”ç”¨æœ‰ bug ç–¯ç‹‚åƒèµ„æºï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°å…¶ä»–å®¹å™¨ã€‚  
cgroupsï¼ˆControl Groupsï¼‰è´Ÿè´£é™åˆ¶å’Œç›‘æ§å®¹å™¨çš„èµ„æºä½¿ç”¨ï¼š

+ **CPU æ§åˆ¶**ï¼šç²¾ç¡®æ§åˆ¶ CPU ä½¿ç”¨ç‡ã€æ—¶é—´ç‰‡åˆ†é…å’Œè°ƒåº¦ä¼˜å…ˆçº§ã€‚
+ **å†…å­˜ç®¡ç†**ï¼šé™åˆ¶å†…å­˜ä½¿ç”¨ä¸Šé™ï¼Œé˜²æ­¢å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰å½±å“å®¿ä¸»æœºã€‚
+ **å­˜å‚¨ I/O**ï¼šæ§åˆ¶ç£ç›˜è¯»å†™å¸¦å®½ã€IOPS å’Œè®¿é—®ä¼˜å…ˆçº§ã€‚
+ **ç½‘ç»œå¸¦å®½**ï¼šé™åˆ¶ç½‘ç»œæµé‡ï¼Œç¡®ä¿ç½‘ç»œèµ„æºå…¬å¹³åˆ†é…ã€‚

### UnionFSï¼šé«˜æ•ˆåˆ†å±‚æ–‡ä»¶ç³»ç»Ÿ
è¿™ä¸ªæœ€æœ‰æ„æ€ã€‚ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºéƒ½è¦å®Œæ•´å¤åˆ¶ä¸€ä»½æ“ä½œç³»ç»Ÿï¼Œå¤ªæµªè´¹äº†ã€‚UnionFS å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œåº•å±‚æ˜¯åŸºç¡€çš„ Ubuntu ç³»ç»Ÿï¼Œä¸Šé¢ä¸€å±‚æ˜¯ Java è¿è¡Œç¯å¢ƒï¼Œå†ä¸Šé¢ä¸€å±‚æ˜¯ä½ çš„åº”ç”¨ä»£ç ã€‚

å…³é”®æ˜¯ï¼Œå¦‚æœ 10 ä¸ªå®¹å™¨éƒ½ç”¨ Ubuntuï¼Œé‚£è¿™ä¸ª Ubuntu å±‚å°±åªå­˜ä¸€ä»½ï¼Œå¤§å®¶å…±äº«ã€‚åªæœ‰å½“ä½ è¦ä¿®æ”¹æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿæ‰ä¼š"å†™æ—¶å¤åˆ¶"ï¼ŒæŠŠæ–‡ä»¶å¤åˆ¶åˆ°ä½ è‡ªå·±çš„å±‚é‡Œæ”¹ã€‚è¿™æ ·æ—¢èŠ‚çœç©ºé—´ï¼Œå¯åŠ¨ä¹Ÿå¿«ã€‚

UnionFS å®ç°äº† Docker é•œåƒçš„é«˜æ•ˆå­˜å‚¨å’Œç®¡ç†ï¼š

+ **åˆ†å±‚å­˜å‚¨æ¶æ„**ï¼šé•œåƒé‡‡ç”¨åˆ†å±‚è®¾è®¡ï¼Œæ¯å±‚ä»…å­˜å‚¨ä¸ä¸Šå±‚çš„å¢é‡å˜åŒ–
+ **å†™æ—¶å¤åˆ¶æœºåˆ¶**ï¼šæ–‡ä»¶ä¿®æ”¹æ—¶æ‰è¿›è¡Œå®é™…å¤åˆ¶ï¼Œå¤§å¹…å‡å°‘å­˜å‚¨å¼€é”€
+ **å±‚çº§å…±äº«ä¼˜åŒ–**ï¼šå¤šä¸ªå®¹å™¨å¯å…±äº«ç›¸åŒçš„åŸºç¡€é•œåƒå±‚ï¼Œæ˜¾è‘—èŠ‚çœå­˜å‚¨ç©ºé—´å’Œå¯åŠ¨æ—¶é—´

è¿™ä¸‰ä¸ªæŠ€æœ¯é…åˆèµ·æ¥å°±å¾ˆç¥å¥‡äº†ï¼šNamespace è®©æ¯ä¸ªå®¹å™¨éƒ½ä»¥ä¸ºè‡ªå·±æ˜¯ç‹¬ç«‹çš„ç³»ç»Ÿï¼Œcgroups ç¡®ä¿èµ„æºä½¿ç”¨ä¸ä¼šå¤±æ§ï¼ŒUnionFS è®©å­˜å‚¨é«˜æ•ˆåˆçµæ´»ã€‚

ç»“æœå°±æ˜¯ï¼Œä½ èƒ½åœ¨å‡ ç§’é’Ÿå†…å¯åŠ¨ä¸€ä¸ª"çœ‹èµ·æ¥åƒå®Œæ•´ç³»ç»Ÿ"çš„å®¹å™¨ï¼Œä½†å®é™…ä¸Šå®ƒåªæ˜¯å®¿ä¸»æœºä¸Šçš„ä¸€ä¸ªè¢«ç²¾å¿ƒåŒ…è£…çš„è¿›ç¨‹ç»„è€Œå·²ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Docker æ¯”è™šæ‹Ÿæœºè½»é‡é‚£ä¹ˆå¤šçš„åŸå› ã€‚



è™½ç„¶ Docker Hub ä¸Šæœ‰å¾ˆå¤šç°æˆçš„é•œåƒï¼Œä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦æ ¹æ®è‡ªå·±çš„é¡¹ç›®å®šåˆ¶é•œåƒã€‚è¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° **Dockerfile** äº†ã€‚

Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨æ¥å‘Šè¯‰ Docker å¦‚ä½•ä¸€æ­¥æ­¥è‡ªåŠ¨åŒ–æ„å»ºä½ æƒ³è¦çš„é•œåƒã€‚

åŸºæœ¬æµç¨‹ï¼š

![ç”»æ¿](https://cdn.nlark.com/yuque/0/2025/jpeg/21596389/1748336677147-987e6d60-f995-429c-8a88-db78a2f8e5c1.jpeg)

## Dockerfile å¸¸ç”¨æŒ‡ä»¤
![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748584967750-ede15854-32e2-4133-9595-2fa34ff4398f.png)

### 1. FROM - **é€‰æ‹©ä¸€ä¸ªå¥½çš„åŸºç¡€é•œåƒ**
```dockerfile
FROM ubuntu:20.04
FROM node:16-alpine
```

è¿™ä¸ªå¿…é¡»æ”¾ç¬¬ä¸€è¡Œï¼ˆæ³¨é‡Šé™¤å¤–ï¼‰ï¼Œå°±åƒç›–æˆ¿å­å…ˆæ‰“åœ°åŸºä¸€æ ·ã€‚

æ¨èä½¿ç”¨å®˜æ–¹çš„ã€ç»è¿‡éªŒè¯çš„åŸºç¡€é•œåƒã€‚`alpine` ç‰ˆæœ¬æ›´å°å·§ï¼Œæ˜¾è‘—å‡å°é•œåƒä½“ç§¯ï¼ŒåŠ å¿«ä¸‹è½½é€Ÿåº¦ï¼Œä½† `alpine` å¯èƒ½ç¼ºå°‘ä¸€äº›å¸¸ç”¨å·¥å…·ï¼Œéœ€è‡ªè¡Œå®‰è£…ã€‚

### 2. RUN - **æ‰§è¡Œå‘½ä»¤å¹¶æ„å»ºå±‚**
```dockerfile
RUN apt-get update && apt-get install -y nginx
RUN npm install
```

æ¯ä¸ª RUN éƒ½ä¼šæ–°å¢ä¸€å±‚ã€‚

ä¸ºäº†å‡å°‘é•œåƒå±‚æ•°å’Œä½“ç§¯ï¼Œåº”å°†å¤šä¸ªç›¸å…³å‘½ä»¤ç”¨ `&&` å’Œ `\` (æ¢è¡Œç¬¦) è¿æ¥åœ¨å•ä¸ª `RUN` æŒ‡ä»¤ä¸­ã€‚ä¾‹å¦‚ï¼š

```dockerfile
RUN apt-get update && apt-get install -y \
    package1 \
    package2 \
    && rm -rf /var/lib/apt/lists/*
```

### 3. CMD - **å®¹å™¨å¯åŠ¨æ—¶é»˜è®¤æ‰§è¡Œçš„å‘½ä»¤**
```dockerfile
CMD ["nginx", "-g", "daemon off;"]  # æ¨èè¿™ç§å†™æ³•
CMD nginx -g "daemon off;"          # ä¹Ÿè¡Œï¼Œä½†ä¸å¦‚ä¸Šé¢çš„å¥½
```

ä¸€ä¸ª Dockerfile åªèƒ½æœ‰ä¸€ä¸ª CMDï¼Œå¦‚æœå®šä¹‰äº†å¤šä¸ªï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆã€‚

å¦‚æœ `docker run` çš„æ—¶å€™æŒ‡å®šäº†å‘½ä»¤ï¼Œ`CMD` çš„å†…å®¹ä¼šè¢«è¦†ç›–ã€‚

### 4. ENTRYPOINT - **é…ç½®å®¹å™¨å¯åŠ¨æ—¶çš„â€œå…¥å£ç‚¹â€**
```dockerfile
ENTRYPOINT ["java", "-jar", "myapp.jar"]
ENTRYPOINT ["/usr/sbin/nginx", "-g", "daemon off;"]
```

ä¸ CMD ç±»ä¼¼ï¼Œä½† ENTRYPOINT æŒ‡å®šçš„å‘½ä»¤ä¸å®¹æ˜“åœ¨ docker run æ—¶è¢«è¦†ç›–ï¼ˆéœ€è¦ä½¿ç”¨ --entrypoint å‚æ•°æ˜¾å¼è¦†ç›–ï¼‰ã€‚

ENTRYPOINT ä¸ CMD ç»„åˆä½¿ç”¨ï¼š

```dockerfile
ENTRYPOINT ["echo", "Hello"]
CMD ["world"]
```

+ `docker run myimage` -> è¾“å‡º `Hello world`
+ `docker run myimage Docker` -> è¾“å‡º `Hello Docker` (`CMD` çš„ `world` è¢« `Docker` è¦†ç›–)

 ENTRYPOINT ç¡®ä¿å®¹å™¨å§‹ç»ˆæ‰§è¡Œç‰¹å®šçš„ä¸»å‘½ä»¤ï¼ŒCMD æä¾›çµæ´»çš„é»˜è®¤å‚æ•°ï¼Œå¯åœ¨è¿è¡Œæ—¶è½»æ¾è¦†ç›–

### 5. WORKDIR - è®¾ç½®å·¥ä½œç›®å½•
```dockerfile
WORKDIR /app
```

ä¸ºåç»­çš„ `RUN`, `CMD`, `ENTRYPOINT`, `COPY`, `ADD` æŒ‡ä»¤è®¾ç½®å·¥ä½œç›®å½•ï¼Œé¿å…é¢‘ç¹å†™ç»å¯¹è·¯å¾„ã€‚å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œ`WORKDIR` ä¼šè‡ªåŠ¨åˆ›å»ºå®ƒã€‚

### 6. COPY vs ADD - **å¤åˆ¶æ–‡ä»¶/ç›®å½•åˆ°é•œåƒ**
```dockerfile
COPY ./myapp /app/myapp     # è€å®æœ¬åˆ†ï¼Œå°±æ˜¯å¤åˆ¶
ADD source.tar.gz /app/ # èƒ½è§£å‹ï¼Œè¿˜èƒ½ä»ç½‘ä¸Šä¸‹è½½
```

`COPY`ï¼šå°†æ–‡ä»¶æˆ–ç›®å½•ä»æ„å»ºä¸Šä¸‹æ–‡å¤åˆ¶åˆ°é•œåƒæ–‡ä»¶ç³»ç»Ÿä¸­ã€‚

`ADD`ï¼šåŠŸèƒ½ä¸ `COPY` ç±»ä¼¼ï¼Œä½†å¢åŠ äº†ä¸¤ä¸ªé¢å¤–åŠŸèƒ½ï¼š

1. å¦‚æœæºæ–‡ä»¶æ˜¯å¯è¯†åˆ«çš„å‹ç¼©åŒ…ï¼ˆå¦‚ `tar.gz`ï¼‰ï¼Œ`ADD` ä¼šè‡ªåŠ¨è§£å‹ã€‚
2. å¦‚æœæºæ–‡ä»¶æ˜¯ URLï¼Œ`ADD` ä¼šå°è¯•ä¸‹è½½æ–‡ä»¶ã€‚

**å»ºè®®**ï¼š99% çš„æƒ…å†µç”¨ `COPY` å°±å¤Ÿäº†ï¼Œ`ADD` åŠŸèƒ½å¤ªå¤šåè€Œå®¹æ˜“å‡ºé—®é¢˜ã€‚

### 7. EXPOSE - **å£°æ˜å®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç«¯å£**
```dockerfile
EXPOSE 80
EXPOSE 8080/tcp
EXPOSE 53/udp
```

å£°æ˜å®¹å™¨åœ¨è¿è¡Œæ—¶ä¼šç›‘å¬çš„ç½‘ç»œç«¯å£ã€‚

âš ï¸ `EXPOSE` **ä¸ä¼š**è‡ªåŠ¨å°†ç«¯å£å‘å¸ƒåˆ°å®¿ä¸»æœºã€‚è¦åœ¨å®¿ä¸»æœºä¸Šè®¿é—®å®¹å™¨ç«¯å£ï¼Œä»éœ€åœ¨ `docker run` æ—¶ä½¿ç”¨ `-p` æˆ– `-P` å‚æ•°ã€‚

### 8. ENV - è®¾ç½®ç¯å¢ƒå˜é‡
```dockerfile
ENV NODE_ENV=production
ENV APP_VERSION="1.0.0"
```

è®¾ç½®ç¯å¢ƒå˜é‡ã€‚è¿™äº›å˜é‡åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼ˆåç»­æŒ‡ä»¤ï¼‰å’Œå®¹å™¨è¿è¡Œæ—¶éƒ½å¯ç”¨ã€‚

### 9. VOLUME - **å£°æ˜æŒ‚è½½ç‚¹**
```dockerfile
VOLUME ["/var/lib/mysql"]
VOLUME /data
```

å£°æ˜å®¹å™¨ä¸­å¸Œæœ›æŒä¹…åŒ–æˆ–ç”±å¤–éƒ¨ç®¡ç†çš„ç›®å½•ã€‚è¿™æœ‰åŠ©äºé•œåƒä½¿ç”¨è€…äº†è§£å“ªäº›è·¯å¾„é€‚åˆæŒ‚è½½å·ã€‚

å®é™…æŒä¹…åŒ–é€šè¿‡ `docker run -v /host_path:/var/lib/mysql` (ç»‘å®šæŒ‚è½½) æˆ– `docker run -v volume_name:/var/lib/mysql`(å‘½åå·) æ¥å®ç°ã€‚

å¦‚æœæ²¡æœ‰æä¾› `host_path`ï¼Œæ¯”å¦‚ç›´æ¥ `docker run -d your_image`ï¼ŒDocker ä¼šåˆ›å»ºåŒ¿åå·æŒ‚è½½åˆ°æˆ‘ä»¬å£°æ˜çš„ `VOLUME`ã€‚

### 10. USER - åˆ«è€ç”¨ root
```dockerfile
USER nginx
USER 1001
USER appuser:appgroup
```

æŒ‡å®šè¿è¡Œåç»­ `RUN`, `CMD`, `ENTRYPOINT` æŒ‡ä»¤æ—¶ä½¿ç”¨çš„ç”¨æˆ·åæˆ– UIDï¼ˆä»¥åŠå¯é€‰çš„ç»„åæˆ– GIDï¼‰

âš ï¸ é™¤éç»å¯¹å¿…è¦ï¼Œå¦åˆ™ä¸è¦ä½¿ç”¨ `root` ç”¨æˆ·è¿è¡Œåº”ç”¨ã€‚åœ¨ Dockerfile ä¸­åˆ›å»ºä¸€ä¸ªé `root` ç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨ `USER` æŒ‡ä»¤åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·ã€‚

### 11. LABEL - **ä¸ºé•œåƒæ·»åŠ å…ƒæ•°æ®**
```dockerfile
LABEL maintainer="zhang@example.com" 
LABEL version="1.0"
LABEL description="æˆ‘çš„è¶…æ£’åº”ç”¨"
```

ä»¥é”®å€¼å¯¹çš„å½¢å¼ä¸ºé•œåƒæ·»åŠ å…ƒæ•°æ®ï¼Œå¦‚ç»´æŠ¤è€…ã€ç‰ˆæœ¬å·ã€æè¿°ç­‰ã€‚æ–¹ä¾¿ç»„ç»‡å’Œç®¡ç†é•œåƒã€‚

## docker build - æ„å»ºé•œåƒ
```bash
docker build -t myapp:latest .
```

`-t myapp:latest`ï¼šç»™é•œåƒæ‰“ä¸Šæ ‡ç­¾ï¼ˆåç§°:ç‰ˆæœ¬å·ï¼‰ã€‚

`.` (ç‚¹)ï¼šæŒ‡å®šå½“å‰ç›®å½•ä¸ºæ„å»ºä¸Šä¸‹æ–‡ã€‚Docker å®ˆæŠ¤è¿›ç¨‹ä¼šåŠ è½½æ­¤ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆéµå¾ª `.dockerignore` è§„åˆ™ï¼‰ç”¨äºæ„å»ºã€‚

### å¸¸ç”¨å‚æ•°
1. **æŒ‡å®š Dockerfile æ–‡ä»¶ **

å½“ Dockerfile æ–‡ä»¶åä¸æ˜¯é»˜è®¤çš„ Dockerfile æˆ–ä¸åœ¨æ„å»ºä¸Šä¸‹æ–‡æ ¹ç›®å½•æ—¶ï¼Œéœ€è¦ä½¿ç”¨ -f å‚æ•°æŒ‡å®šæ–‡ä»¶è·¯å¾„ã€‚ 

æ ¼å¼ï¼š

```bash
docker build -f <dockerfile-path> -t <image-name>:<tag> <build-context>
```

ä¾‹å­ï¼š

```bash
docker build -f /path/to/MyDockerfile -t myapp:1.0 .
```

2. **ä¼ é€’æ„å»ºæ—¶å‚æ•° (**`**--build-arg**`**)ï¼š**

```dockerfile
# Dockerfile ä¸­å®šä¹‰
ARG VERSION=latest
ENV APP_VERSION=${VERSION}
RUN echo "Building version ${APP_VERSION}"
```

```dockerfile
# æ„å»ºå‘½ä»¤
docker build --build-arg VERSION=1.2.3 -t myapp:1.2.3 .
```

3. **ç¦ç”¨ç¼“å­˜ï¼ˆ--no-cacheï¼‰**

å½“ç¼“å­˜å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œæˆ–éœ€è¦ç¡®ä¿æ¯ä¸€æ­¥éƒ½é‡æ–°æ‰§è¡Œæ—¶ï¼š

```dockerfile
docker build --no-cache -t myapp:latest .
```

4. **æŒ‡å®šæ„å»ºå¹³å°ï¼ˆ--platformï¼‰**

ç”¨äºå¤šå¹³å°æ„å»ºï¼Œä¾‹å¦‚åœ¨ Apple Silicon Mac ä¸Šæ„å»º x86_64 é•œåƒï¼š

```dockerfile
docker build --platform linux/amd64 -t myapp-amd64:latest .
```

5. **å…¶ä»–å®ç”¨å‚æ•°**

```dockerfile
# é™é»˜æ¨¡å¼ï¼Œå‡å°‘è¾“å‡ºä¿¡æ¯
docker build -q -t myapp:latest .

# è®¾ç½®æ„å»ºæ—¶çš„å†…å­˜é™åˆ¶
docker build -m 1g -t myapp:latest .

# æŒ‡å®šæ„å»ºç›®æ ‡é˜¶æ®µï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰
docker build --target production -t myapp:prod .
```



## `.dockerignore` æ–‡ä»¶
åœ¨æŠŠæ„å»ºä¸Šä¸‹æ–‡å‘é€ç»™ Docker Daemonï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ä¹‹å‰ã€‚

æˆ‘ä»¬é€šå¸¸ä¼šç”¨åˆ°ä¸€ä¸ªå«åš `.dockerignore` çš„æ–‡ä»¶ã€‚å®ƒçš„ä½œç”¨å’Œ `.gitignore` ç±»ä¼¼ï¼Œå‘Šè¯‰ Docker åœ¨æ„å»ºé•œåƒæ—¶å“ªäº›æ–‡ä»¶æˆ–ç›®å½•å¯ä»¥è¢«å¿½ç•¥æ‰ã€‚

ç¤ºä¾‹ï¼š

```dockerfile
# ä¾èµ–å’Œæ„å»ºäº§ç‰©
node_modules/
dist/
build/

# å¼€å‘å·¥å…·é…ç½®
.vscode/
.idea/
*.log

# æ•æ„Ÿæ–‡ä»¶
.env
.env.local
*.key
*.pem

# æ–‡æ¡£ï¼ˆæ ¹æ®éœ€è¦ï¼‰
*.md
!README.md

# Git ç›¸å…³
.git/
.gitignore
```

èƒ½æœ‰æ•ˆå‡å°‘æ„å»ºå¤§å°ï¼ŒåŠ å¿«æ„å»ºé€Ÿåº¦ä»¥åŠè„±æ•ã€‚

`.dockerignore` æ”¯æŒçµæ´»çš„åŒ¹é…æ¨¡å¼ï¼š

+ `*.md` - å¿½ç•¥æ‰€æœ‰ .md æ–‡ä»¶ï¼ˆå¦‚æ–‡æ¡£ï¼‰
+ `!README.md` - æ’é™¤è§„åˆ™ï¼Œå³ä½¿åŒ¹é…äº† `*.md`ï¼Œä¹Ÿä¿ç•™ README.md
+ `node_modules/` - å¿½ç•¥æ•´ä¸ª node_modules ç›®å½•
+ `**/*.log` - å¿½ç•¥æ‰€æœ‰å­ç›®å½•ä¸­çš„ .log æ–‡ä»¶
+ `temp*` - å¿½ç•¥ä»¥ temp å¼€å¤´çš„æ–‡ä»¶æˆ–ç›®å½•
+ `.git/` - å¿½ç•¥ Git ä»“åº“ä¿¡æ¯



## ğŸŒ° ç”¨ Dockerfile æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰ Nginx é•œåƒ
### å‡†å¤‡æ–‡ä»¶
å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¹ç›®ï¼ŒåŒ…å«ä¸€ä¸ª `index.html` æ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³ç”¨ Nginx æ¥å±•ç¤ºå®ƒï¼š

```html
<!DOCTYPE html>
<html lang="en">
  <head> </head>
  <body>
    hello docker
  </body>
</html>
```

### ç¼–å†™ Dockerfile
åœ¨ `docker test` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `Dockerfile` (æ²¡æœ‰æ‰©å±•å) çš„æ–‡ä»¶ï¼š

```dockerfile
# my-custom-nginx/Dockerfile

# 1. ä½¿ç”¨å®˜æ–¹æœ€æ–°çš„ Nginx é•œåƒä½œä¸ºåŸºç¡€
FROM nginx:latest

# 2. (å¯é€‰) æ·»åŠ æ ‡ç­¾ä¿¡æ¯
# LABEL maintainer="Your Name <your.email@example.com>"
# LABEL version="1.0"

# 3. å°†æˆ‘ä»¬è‡ªå®šä¹‰çš„ index.html æ–‡ä»¶å¤åˆ¶åˆ° Nginx é»˜è®¤çš„ç½‘ç«™æ ¹ç›®å½•
# ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›¸å¯¹äºæ„å»ºä¸Šä¸‹æ–‡çš„æºè·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é•œåƒå†…çš„ç›®æ ‡è·¯å¾„
COPY ./index.html /usr/share/nginx/html/index.html

# 4. (å¯é€‰) å£°æ˜å®¹å™¨å°†ç›‘å¬ 80 ç«¯å£ (Nginx é»˜è®¤å°±æ˜¯ 80)
EXPOSE 80

# 5. å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œçš„å‘½ä»¤ï¼šä»¥å‰å°æ¨¡å¼å¯åŠ¨ Nginx
# "daemon off;" æ˜¯ Nginx çš„ä¸€ä¸ªæŒ‡ä»¤ï¼Œè®©å®ƒåœ¨å‰å°è¿è¡Œï¼Œè¿™å¯¹äº Docker å®¹å™¨æ˜¯å¿…è¦çš„
CMD ["nginx", "-g", "daemon off;"]
```

### æ„å»ºé•œåƒ
æ‰“å¼€å‘½ä»¤è¡Œ`docker build`ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748159160093-16022ea0-9ea7-4d82-ba16-094578abb3c5.png)

ä½ ä¼šçœ‹åˆ° Dockerfile ä¸­çš„æŒ‡ä»¤ä¸€æ­¥æ­¥æ‰§è¡Œã€‚

+ `-t my-app:v1` ç»™æ–°é•œåƒå‘½åä¸º `my-app`ï¼Œæ ‡ç­¾ä¸º `v1`ã€‚
+ `.` è¡¨ç¤ºä½¿ç”¨å½“å‰ç›®å½•ä½œä¸ºæ„å»ºä¸Šä¸‹æ–‡ï¼ŒDocker ä¼šåœ¨è¿™ä¸ªç›®å½•é‡Œå¯»æ‰¾ `Dockerfile`ã€‚

æˆ‘ä»¬ä¸Šé¢ä½¿ç”¨ docker build å‘½ä»¤æ„å»ºä¸€ä¸ªåä¸º `my-app`ã€æ ‡ç­¾ä¸º `v1` çš„é•œåƒï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748159212029-1b412e01-daa0-4023-9bed-69466d47c235.png)

ç‚¹å‡» run å¡«å†™å‚æ•°

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748159268768-f707f84a-8696-4f42-91c3-a772ce2c7bcf.png)

ç‚¹å‡» Run ä¹‹åï¼Œè®¿é—®é¡µé¢ [localhost:9999/](http://localhost:9999/)ï¼š

![](https://lh3.googleusercontent.com/gg-dl/AJfQ9KQKmhYl9M6OMKLrvZLUM0_GqnafwQmVReOmd0S2ooz8ZxIScvUc-1W7uxU8I45rWMUpqWT7np25SLjBGZtBoswnir97NXJeqIZPStglC7Ow-mHeC3XiGqAnODoNtmqIhcYDTbJAUWhhuA4-O5KGeJQM0zlvrUh39koEWT1ELp441wLMtg)![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748159440675-fa1dca03-63f1-452a-a45c-83cf929c5c51.png)

è¿›å…¥å®¹å™¨ filesï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748159465709-e6bf5880-dbce-435d-9ff0-ddbd20bf94ae.png)

å¯ä»¥å‘ç°è¿™ä¸ª index.html æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬ä¹‹å‰é¡¹ç›®ç›®å½•ä¸‹ index.html æ–‡ä»¶ã€‚

æœ‰æ²¡æœ‰åŠæ³•ï¼Œæˆ‘ä»¬é¡¹ç›® index.html æ”¹åŠ¨ï¼Œå®¹å™¨å†…è·Ÿç€æ”¹å‘¢ï¼Ÿ

æˆ‘ä»¬è¿è¡Œé•œåƒï¼š

```bash
docker run --name my-app-test2 -d -v ./:/usr/share/nginx/html -p 8888:80 my-app:v1
```

ä½¿ç”¨ `-v ./:/usr/share/nginx/htm`ï¼šå½“å‰ç›®å½•ï¼ˆ./ï¼‰è¢«æ˜ å°„åˆ°å®¹å™¨å†…çš„ `/usr/share/nginx/html` ç›®å½•ã€‚è¿™æ„å‘³ç€å¯¹å®¿ä¸»æœºå½“å‰ç›®å½•çš„ä»»ä½•æ›´æ”¹éƒ½ä¼šåæ˜ åœ¨å®¹å™¨çš„ `/usr/share/nginx/html` ç›®å½•ä¸­ï¼Œåä¹‹äº¦ç„¶ã€‚

ä¿®æ”¹ index.html æ–‡ä»¶ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748159954184-b79bf8d6-29e4-40bf-b172-9a3bfb9fa213.png)

è®¿é—® [localhost:8888/](http://localhost:8888/)ï¼š

![](https://cdn.nlark.com/yuque/0/2025/png/21596389/1748160471887-9fa4dc7f-0a94-42bb-8786-8a8a730e58cc.png)

æˆåŠŸã€‚

