# 写作提示 —— 流式协议细节与粘合层（SSE、WS、gRPC）

使用说明：
- 生成统一流式事件格式与适配层的工程实践，提升跨供应商与跨协议的可维护性。

生成目标：
- 总结 SSE、WebSocket、gRPC 的流式差异、事件模型与兼容性问题。
- 定义统一的 delta 事件格式（文本增量、函数调用事件、错误事件）。
- 处理 Back-pressure、取消/超时、重连、心跳、网络抖动与代理中间层问题。

大纲建议：
1. 协议对比（握手、事件、可靠性与兼容性）
2. 统一事件格式（delta、完成、错误、心跳、meta）
3. 取消/超时与资源控制（中止信号、优雅结束）
4. 重连与断点续传策略（游标/偏移）
5. Markdown/代码块增量渲染与粘合层处理
6. 代理/网关层的适配（多供应商事件桥接与转译）
7. 观测与调试（事件日志、指标、追踪）

输出格式要求：
- Markdown；附最小适配层代码片段与前端消费示例。
- 给出取消、重连与心跳的实现方案与参数建议。

质量检查清单：
- 粘合层设计可复用；覆盖主流协议与供应商差异。
- 流式渲染稳定，错误与中止处理明确。
- 有观测与调试手段，便于定位问题。

