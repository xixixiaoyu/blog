# 写作提示 —— 前端聊天应用架构

使用说明：
- 生成一个可落地的聊天应用架构说明，覆盖前后端与流式交互。

生成目标：
- 给出架构图与数据流：UI → 代理层 → 模型 → 观测。
- 说明消息结构、角色（system/user/assistant）、函数调用消息与工具执行返回。
- 提供 SSE/WebSocket 的流式渲染示例与错误处理策略。

大纲建议：
1. 需求与约束（延迟、并发、成本、可靠性）
2. 架构图与数据流（组件与职责）
3. 消息模型与持久化（历史、裁剪、上下文管理）
4. 流式通信（SSE/WebSocket，前端渲染管线）
5. 函数调用与工具执行（结果插入与二次生成）
6. 观测与日志（提示、响应、错误、性能）
7. 权限与配额（用户级限制、风控）
8. 常见问题与用户体验优化（重试、提示引导）

输出格式要求：
- Markdown；附最小代码示例与组件拆分建议。
- 给出状态管理与错误处理的统一模式。

质量检查清单：
- 架构清晰，示例可运行或易于运行。
- 用户体验与工程约束均有考虑。
- 提供观测与可维护性方案。
