# 写作提示 —— 结构化解码与 JSON、Grammar、函数调用的稳健性

使用说明：
- 生成结构化输出与函数调用稳健性的工程指南，降低幻觉与解析失败。

生成目标：
- 比较 JSON 输出、JSON Schema 校验、Grammar/Constraint 解码（如 JSON Mode/Grammar-based）的差异。
- 设计结构化输出协议与错误恢复策略（重试、局部修复、降级）。
- 提供函数调用参数校验、幂等与安全策略。

大纲建议：
1. 结构化输出方案对比（JSON、Schema、Grammar）
2. 错误恢复与重试（解析失败、字段缺失、类型错误）
3. 函数调用参数校验（Schema、边界与默认值）
4. 幂等与事务（重复调用、回滚与补偿）
5. 安全与防御（越权、注入、沙箱）
6. 评估与回归（结构化正确率、失败模式）

输出格式要求：
- Markdown；附最小结构化解码示例与函数调用校验代码片段。
- 给出错误恢复流程图或文字说明。

质量检查清单：
- 输出可解析且可校验；失败可恢复。
- 函数调用安全与幂等；不造成副作用。
- 有评估与回归指标。

