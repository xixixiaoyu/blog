# AI Prompt: 从零到一：用 Go 构建一个 TODO 应用

请你扮演一位经验丰富的 Go 开发者和技术作家，撰写一篇关于如何使用 Go 从零开始构建一个 RESTful TODO 应用的详细教程。

这篇文章的目标是引导初学者和中级开发者完成一个真实项目的开发全过程，不仅展示代码实现，更要阐述其背后的设计思想和工程实践。

**文章核心内容应包括：**

1.  **引言**
    *   项目概述：我们将构建一个什么样的 TODO 应用（功能：任务创建、查看、更新、删除）。
    *   技术栈预览：Go, Gin (Web 框架), GORM (ORM), SQLite (数据库)。
    *   最终成果：一个可以通过 cURL 或 Postman 交互的 API 服务。

2.  **项目初始化与结构设计**
    *   初始化 Go Module (`go mod init`)。
    *   **分层架构设计**：详细解释为什么采用分层架构，并创建以下目录结构：
        *   `main.go`: 程序入口。
        *   `api/`: 存放 API Handler (路由层)。
        *   `service/`: 存放业务逻辑层。
        *   `repository/`: 存放数据访问层。
        *   `model/`: 存放数据模型 (struct)。
        *   `config/`: 存放配置管理。
        *   `db/`: 存放数据库初始化逻辑。
    *   说明各层职责，强调“关注点分离”原则。

3.  **模型与数据库层 (Repository)**
    *   定义 `Task` 模型 (`model/task.go`)，包含 ID, Title, Status, CreatedAt, UpdatedAt 等字段。
    *   使用 GORM 连接 SQLite 数据库 (`db/database.go`)，并实现自动迁移 (AutoMigrate)。
    *   创建 `TaskRepository` 接口和实现 (`repository/task_repository.go`)，封装对 `Task` 表的 CRUD (Create, Read, Update, Delete) 操作。
        *   `Create(task *model.Task) error`
        *   `FindAll() ([]model.Task, error)`
        *   `FindByID(id uint) (*model.Task, error)`
        *   `Update(task *model.Task) error`
        *   `Delete(id uint) error`
    *   **代码要求**：提供完整的 Repository 层实现代码，并解释 GORM 的关键用法。

4.  **业务逻辑层 (Service)**
    *   创建 `TaskService` (`service/task_service.go`)，它依赖 `TaskRepository` 接口。
    *   实现处理业务逻辑的方法，例如在创建任务时设置默认状态，在更新时检查任务是否存在等。
    *   **代码要求**：展示如何通过依赖注入将 Repository 注入 Service，并提供 Service 层的核心实现。

5.  **API 路由层 (Handler)**
    *   使用 Gin 框架设置路由 (`api/router.go`)。
    *   创建 `TaskHandler` (`api/task_handler.go`)，它依赖 `TaskService`。
    *   为 TODO 应用的 CRUD 操作创建对应的 Handler 函数：
        *   `CreateTask(c *gin.Context)`: `POST /tasks`
        *   `GetTasks(c *gin.Context)`: `GET /tasks`
        *   `GetTask(c *gin.Context)`: `GET /tasks/:id`
        *   `UpdateTask(c *gin.Context)`: `PUT /tasks/:id`
        *   `DeleteTask(c *gin.Context)`: `DELETE /tasks/:id`
    *   **代码要求**：提供完整的 Handler 实现，包括如何从请求中解析参数、调用 Service、处理错误并返回 JSON 响应。

6.  **组装与运行 (`main.go`)**
    *   在 `main.go` 中，将所有组件（数据库、Repository、Service、Handler、Router）组装起来。
    *   实现优雅的依赖注入过程。
    *   启动 Gin 服务器。
    *   **代码要求**：提供完整的 `main.go` 文件内容。

7.  **最佳实践与总结**
    *   **错误处理**：如何在各层之间传递和处理错误。
    *   **配置管理**：如何从环境变量或配置文件中读取数据库连接信息和服务器端口。
    *   **测试**：简要说明如何为 Repository 或 Service 编写单元测试。
    *   **总结**：回顾项目，并提出可以进一步扩展的功能（例如：用户认证、任务标签等）。

**总结要求：**

请确保文章结构清晰，代码可直接运行。在解释代码时，不仅要说明“它做了什么”，更要解释“为什么这么做”，帮助读者建立起良好的 Go 项目开发思维。

