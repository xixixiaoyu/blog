# Python 文件与目录

## 最佳提示词

```
请详细介绍 Python 的文件与目录操作，包括以下内容：

1. 文件操作：
   - 文件打开与关闭
   - 文件读写模式
   - 文件读取方法
   - 文件写入方法
   - 文件指针操作

2. 目录操作：
   - 目录创建与删除
   - 目录遍历
   - 工作目录管理
   - 路径操作

3. os 模块：
   - 文件系统操作
   - 环境变量
   - 进程管理
   - 系统信息

4. pathlib 模块：
   - Path 对象
   - 路径构建
   - 路径解析
   - 跨平台兼容

5. 文件属性：
   - 文件信息获取
   - 权限管理
   - 文件时间戳
   - 文件大小

6. 高级文件操作：
   - 文件复制移动
   - 临时文件
   - 文件压缩
   - 文件监控

请为每个功能提供详细的代码示例，包括实际应用场景和最佳实践。
```

## 学习要点

- 掌握文件的基本读写操作
- 理解不同的文件打开模式
- 学会使用 os 模块进行系统操作
- 掌握 pathlib 的现代路径处理方式
- 了解文件属性和权限管理
- 学会处理文件系统相关的问题

## 实践练习

1. 实现文件的读写操作
2. 创建目录管理工具
3. 实现文件搜索功能
4. 处理文件权限问题
5. 创建文件备份工具

## 代码示例模板

```python
import os
from pathlib import Path
import shutil
import tempfile
import glob

# 文件基本操作
# 写入文件
with open('example.txt', 'w', encoding='utf-8') as f:
    f.write('Hello, Python!\n')
    f.write('文件操作示例\n')

# 读取文件
with open('example.txt', 'r', encoding='utf-8') as f:
    content = f.read()
    print(f"文件内容:\n{content}")

# 逐行读取
with open('example.txt', 'r', encoding='utf-8') as f:
    for line in f:
        print(f"行: {line.strip()}")

# 二进制文件操作
with open('binary.dat', 'wb') as f:
    f.write(b'Binary data')

with open('binary.dat', 'rb') as f:
    data = f.read()
    print(f"二进制数据: {data}")

# os 模块操作
print(f"当前工作目录: {os.getcwd()}")
print(f"当前目录内容: {os.listdir()}")

# 创建目录
os.makedirs('test_dir/sub_dir', exist_ok=True)
print(f"目录创建成功")

# 目录遍历
for root, dirs, files in os.walk('.'):
    print(f"目录: {root}")
    for file in files[:3]:  # 只显示前3个文件
        print(f"  文件: {file}")

# pathlib 模块操作
current_dir = Path('.')
print(f"当前目录: {current_dir}")
print(f"绝对路径: {current_dir.absolute()}")

# 路径构建
data_dir = Path('data')
file_path = data_dir / 'input.txt'
print(f"文件路径: {file_path}")

# 路径操作
file_path = Path('example.txt')
print(f"文件存在: {file_path.exists()}")
print(f"是否为文件: {file_path.is_file()}")
print(f"文件大小: {file_path.stat().st_size} 字节")
print(f"文件后缀: {file_path.suffix}")

# 文件信息
stat = file_path.stat()
print(f"创建时间: {stat.st_ctime}")
print(f"修改时间: {stat.st_mtime}")
print(f"访问时间: {stat.st_atime}")

# 文件操作
# 复制文件
shutil.copy('example.txt', 'example_copy.txt')

# 移动文件
shutil.move('example_copy.txt', 'moved_example.txt')

# 删除文件
os.remove('moved_example.txt')

# 临时文件
with tempfile.NamedTemporaryFile(mode='w', delete=False) as f:
    f.write('临时文件内容')
    temp_path = f.name

print(f"临时文件路径: {temp_path}")

# 文件搜索
# 使用 glob
txt_files = glob.glob('*.txt')
print(f"所有txt文件: {txt_files}")

# 使用 pathlib
py_files = Path('.').glob('*.py')
print(f"Python文件: {list(py_files)[:5]}")  # 显示前5个

# 文件工具函数
def find_files(directory, pattern):
    """查找匹配模式的文件"""
    path = Path(directory)
    return list(path.glob(pattern))

def get_file_size(file_path):
    """获取文件大小（人类可读格式）"""
    size = Path(file_path).stat().st_size
    for unit in ['B', 'KB', 'MB', 'GB']:
        if size < 1024:
            return f"{size:.2f} {unit}"
        size /= 1024
    return f"{size:.2f} TB"

def backup_file(file_path, backup_dir='backup'):
    """备份文件"""
    source = Path(file_path)
    backup = Path(backup_dir)
    backup.mkdir(exist_ok=True)
    
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    backup_name = f"{source.stem}_{timestamp}{source.suffix}"
    backup_path = backup / backup_name
    
    shutil.copy2(source, backup_path)
    return backup_path

# 使用示例
print(f"找到的txt文件: {find_files('.', '*.txt')}")
print(f"文件大小: {get_file_size('example.txt')}")

# 清理
os.remove('example.txt')
os.remove('binary.dat')
os.remove(temp_path)
shutil.rmtree('test_dir')
```

## 扩展资源

- [os 模块文档](https://docs.python.org/3/library/os.html)
- [pathlib 模块文档](https://docs.python.org/3/library/pathlib.html)
- [shutil 模块文档](https://docs.python.org/3/library/shutil.html)
- [tempfile 模块文档](https://docs.python.org/3/library/tempfile.html)
- [glob 模块文档](https://docs.python.org/3/library/glob.html)